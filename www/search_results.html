<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../mobile_browser_adjustment.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="../www/css/bootstrap.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="../www/js/navigation.js"></script>
        <script src="../www/js/generate-list-search.js"></script>
        <script src="../www/js/floatingAddToCart.js"></script>
        <script src="../www/js/sweetalert.js"></script>
        <script src="../www/js/accessingAccurateAPIsGroup1.js"></script>
        <!-- <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script> -->
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    </head>
<style>
    /* width */
    ::-webkit-scrollbar {
        width: 5px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
        background: #f1f1f1; 
    }
    
    /* Handle */
    ::-webkit-scrollbar-thumb {
        background: #37ced5; 
    }
    
    .red-vantsing-text{
        font-size: 14px;
        color: #37ced5;
    }
    .grey-vantsing-text{
        font-size: 12px;
        color: gray;
    }
    body{
        background-color: white;
    }
    .centering{
        display: table;
        margin: auto;
        /* background-color: cornsilk; */
    }

    /* local */
    table {
        table-layout: fixed;
        word-break: break-all;
        width: 100%;
        border-collapse: collapse;
        background-color: white;
    }

    .main-structure {
        position: relative;
        top: -0.5px;
        left: -0.5px;
        width: 100%;
        height: 100vh;
        border-collapse: collapse;
        text-align: left;
    }
    .middle-structure{
        height: 7%;
        display: none; /*temporary deleted*/
    }
    .bottom-structure{
        padding: 0;
        margin: 0;
        height: 100%;
    }
    .category-icon-background{
        display: table;
        margin: auto;
        border-radius: 50%;
        width: 60%;
    }
    .category-icon{
        width: 100%;
        padding: 10%;
    }
    .flipped{
        transform: rotateX(180deg);
    }
    .notification {
        position: relative;
        display: inline-block;
    }
    .notification .homemade-badge {
        position: absolute;
        top: 0px;
        right: 0px;
        padding: 2.5px 5px;
        border-radius: 50%;
        font-size: x-small;
    }
    .category-icon-badge{
        display: table;
        margin: auto;
        border-radius: 50%;
        background-color: transparent;
        width: 20px;
    }
    .card{
        border: none;
        background: white;
    }

    a{
        text-decoration: none;
    }

    .card-title{
        font-size: 12px;
        max-width: 400px;
        height: 40px;
        min-width:0;
        white-space: nowrap;
        overflow: hidden !important;
        text-overflow: ellipsis;
    }
    .card-img-top{
        border-radius: 0 !important;
        display: table;
        margin: auto;
        height: 200px;
        width: 100%;
    }

    .card-hidden{
        display: none;
    }
    .add-to-cart{
        text-align: right;
    }
    .add-to-cart-button{
        background-color: transparent;
        border-radius: 0;
        border: none;
        padding: 5px;
        color: white;
    }
    .independent-cart-icon{
        width: 20px;
        border-radius: 0% !important;
    }
    .background_image{
        background-image: url('../www/img/background.png'); 
        background-repeat: no-repeat;
        background-attachment: fixed;  
        background-size: cover;
    }
    .slides{
        max-height: auto;
    }
    .options-area{
        display: flex;
        flex-direction: row;
        padding: 1%;
    }
    .option-button{
        border-radius: 10px;
        max-width: 20%;
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        padding: 2%;
        color: #217384;
    }
</style>
<body class="background_image">
    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
          <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="../www/img/ADS_SLIDES/1.png" class="d-block w-100 slides">
            </div>
            <div class="carousel-item">
                <img src="../www/img/ADS_SLIDES/2.png" class="d-block w-100 slides">
            </div>
            <div class="carousel-item">
                <img src="../www/img/ADS_SLIDES/3.png" class="d-block w-100 slides">
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
    <table class="main-structure">
        <tr>
          <td class="middle-structure" >
            <table>
                <tr>
                    <th class="centering">
                        <!-- subtable -->
                        <table>
                            <tr>
                                <th>
                                    <div class="category-icon-background">
                                        <img src="../www/img/Additional_icons/arrow.png" id="arrow-up-price" class="category-icon" onclick="sortUpPrice()">
                                    </div>
                                </th>
                                <th>
                                    <div class="category-icon-background">
                                        <img src="../www/img/Additional_icons/price-tags.png" class="category-icon" >
                                    </div>
                                </th>
                                <th>
                                    <div class="category-icon-background">
                                        <img src="../www/img/Additional_icons/arrow.png" id="arrow-down-price" class="category-icon flipped" onclick="sortDownPrice()">
                                    </div>
                                </th>
                                <th>
                                    <div class="category-icon-background">
                                        <img src="../www/img/Additional_icons/arrow.png" id="arrow-up-alphabet" class="category-icon" onclick="sortUpAlphabet()">
                                    </div>
                                </th>
                                <th>
                                    <div class="category-icon-background">
                                        <img src="../www/img/Additional_icons/blocks.png" class="category-icon" >
                                    </div>
                                </th>
                                <th>
                                    <div class="category-icon-background">
                                        <img src="../www/img/Additional_icons/arrow.png" id="arrow-down-alphabet" class="category-icon flipped" onclick="sortDownAlphabet()">
                                    </div>
                                </th>
                            </tr>
                        </table>
                        <!-- subtable -->
                    </th>
                </tr>
            </table>
          </td>
        </tr>
        <tr>
            <td class="bottom-structure" >
                <div class="options-area">
                    <div class="option-button" onclick="sort_by_price(this)">Harga</div>
                </div>
                <table id="product-highlights">
                    <!-- <div id="product-highlights-small-quantity"></div> -->
                </table>
            </td>
        </tr>
    </table>
    <script>
        var sort_price_counter_click = 0;
        function sort_by_price(x){
            var queryString = window.location.search;
            var urlParams = new URLSearchParams(queryString);
            var search = urlParams.get('input');
            $("#product-highlights").empty();
            if(search.toUpperCase().includes('new'.toUpperCase())){
                var all_new_products = JSON.parse(localStorage.getItem("all_new_products_in_sold_co_id"));
                if(all_new_products.length > 0){
                    loadingMessage(1);
                    if(all_new_products.length == 1){
                        generatehomeleftOnly(all_new_products.length, all_new_products[0], all_new_products.length);
                    }else{
                        // condition works for more than 1 product
                        if(sort_price_counter_click == 0){ // sort from cheap to expensive
                            all_new_products = all_new_products.sort((a,b) => (a.Sell_Price*1 > b.Sell_Price*1) ? 1 : ((b.Sell_Price*1 > a.Sell_Price*1) ? -1 : 0));
                            $(x).css("background-color", "green");
                            $(x).css("color", "white");
                        }else if(sort_price_counter_click == 1){
                            all_new_products = all_new_products.sort((a,b) => (a.Sell_Price*1 < b.Sell_Price*1) ? 1 : ((b.Sell_Price*1 < a.Sell_Price*1) ? -1 : 0));
                            $(x).css("background-color", "darkred");
                            $(x).css("color", "white");
                        }else{
                            $(x).css("background-color", "white");
                            $(x).css("color", "#217384");
                            sort_price_counter_click = 0;
                        }
                        sort_price_counter_click++;
                        var product_row = 0;
                        for(product_row; product_row < all_new_products.length; product_row++){
                            generatehomeOneByOne(product_row, all_new_products[product_row], all_new_products.length);
                        }
                    }
                }else{
                    searchUp("", "", "");
                }
            }else{
                getAllProductsWithoutPaginationWithFilter("", "", "", "", search).done(function (response) {
                    if(response[0] != false){
                        if(response.length == 0){
                            loadingMessage(1);
                            searchUpBasedOnCategory(keywords);
                        }else if(response.length == 1){
                            loadingMessage(response.length);
                            generatehomeleftOnly(response.length, response[0], response.length);
                        }else{
                            // condition works for more than 1 product
                            if(sort_price_counter_click == 0){ // sort from cheap to expensive
                                response = response.sort((a,b) => (a.Sell_Price*1 > b.Sell_Price*1) ? 1 : ((b.Sell_Price*1 > a.Sell_Price*1) ? -1 : 0));
                                $(x).css("background-color", "green");
                                $(x).css("color", "white");
                            }else if(sort_price_counter_click == 1){
                                response = response.sort((a,b) => (a.Sell_Price*1 < b.Sell_Price*1) ? 1 : ((b.Sell_Price*1 < a.Sell_Price*1) ? -1 : 0));
                                $(x).css("background-color", "darkred");
                                $(x).css("color", "white");
                            }else{
                                $(x).css("background-color", "white");
                                $(x).css("color", "#217384");
                                sort_price_counter_click = 0;
                            }
                            sort_price_counter_click++;
                            loadingMessage(response.length);
                            var product_row = 0;
                            for(product_row; product_row < response.length; product_row++){
                                generatehomeOneByOne(product_row, response[product_row], response.length);
                            }
                        }
                    }else{
                        Swal.fire("Item not found", "Mungkin saya bisa menunjukkan hasil pencarian yang berbeda", "warning");
                        setTimeout(() => {
                            searchUp(keywords.substring(1, 2), "", "");
                        }, 3000);
                    }
                });
            }
        }
    </script>
</body>
</html>
